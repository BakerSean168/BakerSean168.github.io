---
title: HTML中的JS脚本
categories:
  - JavaScript
description: HTML中的JS脚本的引入方法，长时间白屏问题
date: 2025-01-18 10:47:58
tags:
---

## JS 基础知识

### 什么是 JS

JS 脚本用来实现网页的交互功能，增加动态性。

### `<script>` 属性

| 属性        | 是否可选 | 说明                                                                                                                                 |
| ----------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| async       | 可选     | - 只对外部脚本文件有效 <br> - 立即开始下载脚本 <br> - 不阻止其他页面动作(如下载资源或等待其他脚本加载)                               |
| charset     | 可选     | - 指定代码字符集 <br> - 适用于使用 src 属性的情况 <br> - 较少使用，多数浏览器忽略此值                                                |
| crossorigin | 可选     | - 配置 CORS(跨源资源共享)设置 <br> - `anonymous`: 不设置凭据标志 <br> - `use-credentials`: 设置凭据标志，出站请求包含凭据            |
| defer       | 可选     | - 只对外部脚本文件有效 <br> - 延迟到文档完全解析和显示后执行 <br> - IE7 及更早版本可用于行内脚本                                     |
| integrity   | 可选     | - 用于验证子资源完整性(SRI) <br> - 通过比对加密签名验证资源 <br> - 签名不匹配会报错且阻止脚本执行 <br> - 可用于防止 CDN 提供恶意内容 |
| language    | 废弃     | - 原用于表示脚本语言 <br> - 多数浏览器忽略此属性 <br> - 不建议使用                                                                   |
| src         | 可选     | - 指定包含要执行代码的外部文件路径                                                                                                   |
| type        | 可选     | - 替代 language 属性 <br> - 表示脚本的内容类型(MIME 类型) <br> - 常用值: `"text/javascript"` <br> - 特殊值`"module"`用于 ES6 模块    |

### `<script>`使用

- 嵌入行内代码
- 引入外部文件

都会按顺序 执行或加载 完后，才能加载其他文件。除非使用 defer 或 async 属性。

## JS 的加载问题

如上所说，直接使用 script 脚本，html 会按照顺序来加载并且执行脚本，在脚本加载和执行的过程中，会阻塞后续 DOM 渲染（html 解析渲染）。

这就引发了大问题：  
如果 JavaScript 脚本文件很大（加载时间长），并且放在网页`<body>`标签（渲染内容）上方时，就会让页面长时间空白（等待脚本加载，内容未渲染）。

解决方法如下。

### 推迟执行脚本

HTML 4.01 为`<script>`元素定义了一个叫 defer 的属性。

含义 脚本在执行的时候不会改变页面的结构，不需要等待该脚本解析再渲染页面

结果：

- 浏览器立即下载脚本（不阻塞其他解析）
- 会被延迟到整个页面都解析完毕后再运行
- 按顺序执行

### 异步执行脚本

async 属性

含义：

- 该脚本相对其他脚本、DOM 解析完全独立

结果：

- 与 defer 相同，不阻塞页面渲染，异步下载
- 下载成功后，如果页面仍在渲染（也可能已经渲染完了），则会停止渲染，先执行该脚本
- 各个脚本执行顺序不一定

### 动态加载脚本

使用 DOM API，向 DOM 中动态添加 script 元素

- 该类型资源默认添加 async 属性
- 对浏览器预加载器不可见  
  影响资源获取优先级， preload

### JS 文件引入位置

放在最下方能加快页面渲染速度

### 设置 setTimeout

使用定时器来延迟加载 js 脚本
